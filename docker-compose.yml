version: "3.9"
services:
  server:
    container_name: server
    image: bertrandmc/express-typescript-seed
    environment:
      - NODE_ENV=development
      - ERROR_LEVEL=error
      - PORT:3000
    build:
      context: .
    volumes:
      - ./:/usr/src/app:delegated
      - /usr/src/app/node_modules
    ports:
      - "3000:3000"
      - "9229:9229"
    command: npm run dev
    depends_on:
      - postgres
  postgres:
    image: "postgis/postgis:11-2.5-alpine"
    environment: 
      - POSTGRES_USER=postgressuser
      - POSTGRES_PASSWORD=postgrespass
    ports:
      - "5432:5432"
  pgadmin:
    image: "dpage/pgadmin4"
    environment: 
      - PGADMIN_LISTEN_PORT=8080
      - PGADMIN_DEFAULT_EMAIL=dev@gov.uk
      - PGADMIN_DEFAULT_PASSWORD=password
    ports:
      - "8080:8080"
      - "5432:5432"
    links: 
      - postgres
