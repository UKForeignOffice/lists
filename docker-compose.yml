version: "3.9"
services:
  postgres:
    platform: linux/arm64
    build:
      context: .
      dockerfile: ./docker/db/Dockerfile
    # if you are on Mac M1 please use the image below
    # see https://github.com/docker/for-mac/issues/5122
    # image: "gangstead/postgis:13-3.1-arm"
    environment:
      - POSTGRES_DB=lists
      - POSTGRES_USER=master
      - POSTGRES_PASSWORD=postgrespass
    ports:
      - "5432:5432"
    volumes:
      - ./config:/usr/src/config
    command: postgres -c config_file=/usr/src/config/postgresql-local.conf
  pgadmin:
    image: "dpage/pgadmin4"
    environment:
      - PGADMIN_LISTEN_PORT=8080
      - PGADMIN_DEFAULT_EMAIL=dev@gov.uk
      - PGADMIN_DEFAULT_PASSWORD=password
    ports:
      - "8080:8080"
    links:
      - postgres
    depends_on:
      - postgres
  pghero:
    image: "ankane/pghero"
    ports:
      - "8081:8080"
    environment:
      - DATABASE_URL=postgresql://postgresuser:postgrespass@postgres:5432/lists
    depends_on:
      - postgres
  redis:
    image: "redis:alpine"
    command: redis-server --requirepass redispassword
    ports:
      - 6379:6379
  redisinsight:
    image: "redislabs/redisinsight:latest"
    ports:
      - "8001:8001"
    depends_on:
      - redis
